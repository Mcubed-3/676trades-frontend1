<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>676Trades - Dashboard</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div class="container">
    <div class="nav">
      <div><b>676Trades</b></div>
      <div style="display:flex;gap:12px;align-items:center;">
        <a href="/account.html">Account</a>
        <a href="/billing.html">Billing</a>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </div>

    <!-- STATUS CARD -->
    <div class="card">
      <h1>Dashboard</h1>
      <div class="small">Controls your MT5 EA. Changes are picked up on the next EA poll.</div>
      <hr/>

      <div class="kv">
        <div><b>Status</b><span id="statusBadge" class="badge off">OFF</span></div>
        <div><b>Pair</b><span id="pairText">-</span></div>
        <div><b>Lot size</b><span id="lotText">-</span></div>
      </div>

      <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;">
        <button id="startBtn">Start Algo</button>
        <button id="stopBtn" class="danger">Stop Algo</button>
        <button id="refreshBtn" class="secondary">Refresh</button>
      </div>

      <div id="msg" class="toast"></div>
    </div>

    <!-- SETTINGS CARD -->
    <div class="card">
      <h2>Trading Settings</h2>

      <div class="row">
        <div>
          <label>Trading Pair</label>
          <input id="pair" value="XAUUSD"/>
        </div>

        <div>
          <label>Lot Size</label>
          <input id="lot" type="number" step="0.01" value="0.01"/>
        </div>
      </div>

      <div class="row">
        <div>
          <label>SL Mode</label>
          <select id="sl_mode">
            <option value="dynamic">Dynamic (pattern-based)</option>
            <option value="fixed">Fixed (pips)</option>
          </select>
        </div>

        <div>
          <label>TP Mode</label>
          <select id="tp_mode">
            <option value="rr">Risk / Reward (RR)</option>
            <option value="pattern_mult">Pattern multiplier</option>
            <option value="fixed">Fixed (pips)</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Minimum pips (SL & TP floor)</label>
          <input id="min_pips" type="number" value="50"/>
        </div>

        <div>
          <label>SL buffer pips (beyond candle high/low)</label>
          <input id="sl_buffer_pips" type="number" value="5"/>
        </div>
      </div>

      <div class="row">
        <div>
          <label>RR (used if TP Mode = RR)</label>
          <input id="rr" type="number" step="0.1" value="1.0"/>
        </div>

        <div>
          <label>Pattern TP Multiplier</label>
          <input id="pattern_tp_mult" type="number" step="0.1" value="1.5"/>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Fixed SL pips</label>
          <input id="fixed_sl_pips" type="number" value="50"/>
        </div>

        <div>
          <label>Fixed TP pips</label>
          <input id="fixed_tp_pips" type=
